<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Letter Page</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: "Courier New", Courier, monospace;
      background: #f9f5f0 url("letter_texture.png") no-repeat center/cover;
      color: #333;
    }

    .photo {
      width: 100%;
      height: 1000px;
      background: #ddd url("jamshedpur.jpg") center/cover no-repeat;
      border-bottom: 2px solid #bbb;
    }

    .letter {
      max-width: 800px;
      width: 90%;
      background: rgba(255, 255, 255, 0.8);
      padding: 20px 30px;
      margin: 20px auto;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      font-size: 18px;
      line-height: 1.7;
    }

    .line {
      display: inline-block;
      border-right: 3px solid black;
      overflow: hidden;
      white-space: nowrap;
    }

    @keyframes blink {
      50% { border-color: transparent; }
    }
  </style>
</head>
<body>
  <div class="photo"></div>
  <div class="letter" id="letter"></div>

  <script>
    const text = `Jamshedpur, the city where you were born. Your beauty, smartness, intelligence, sexiness were enough to remove my racism(somewhat) 
    against people from that region. What can I say, old habits die screaming!!?? I know someone else that should be screaming too hehehehe. Coming 
    back to my topic, I'm so grateful for this city that you were born. It gave me my lover, best friend, future wife, mother of my kids all in
    one. Its your 19th birthday today, I hope I'm in every one of yours from 19 till 90. I love you my dear pumpkin. Mwahh. Have an amazing birthday
    , I can't wait to celebrate it with you later today!!`;

    const letterEl = document.getElementById("letter");
    const words = text.split(" ");
    let currentLine = "";
    const lines = [];

    // Helper: measure line width
    const tester = document.createElement("span");
    tester.style.visibility = "hidden";
    tester.style.whiteSpace = "nowrap";
    tester.style.position = "absolute";
    tester.style.left = "-9999px";
    letterEl.appendChild(tester);

    words.forEach(word => {
      const tryLine = currentLine ? currentLine + " " + word : word;
      tester.textContent = tryLine;
      if (tester.offsetWidth > letterEl.clientWidth - 60) { 
        // commit current line and start new one
        lines.push(currentLine);
        currentLine = word;
      } else {
        currentLine = tryLine;
      }
    });
    if (currentLine) lines.push(currentLine);
    tester.remove();

    // Function to type a line
    function typeLine(line) {
      return new Promise(resolve => {
        const span = document.createElement("span");
        span.className = "line";
        letterEl.appendChild(span);
        letterEl.appendChild(document.createElement("br"));

        let i = 0;
        const cursorBlink = setInterval(() => {
          span.style.borderRight = span.style.borderRight ? "" : "3px solid black";
        }, 500);

        const typer = setInterval(() => {
          span.textContent = line.slice(0, i + 1);
          i++;
          if (i === line.length) {
            clearInterval(typer);
            clearInterval(cursorBlink);
            span.style.borderRight = "none";
            resolve();
          }
        }, 50); // speed per character
      });
    }

    // Sequential typing
    (async function run() {
      for (const line of lines) {
        await typeLine(line);
      }
    })();
  </script>
</body>
</html>

